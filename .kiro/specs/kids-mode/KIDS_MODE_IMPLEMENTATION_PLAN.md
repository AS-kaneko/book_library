# 小学1年生用モード（キッズモード）実装計画

## 現状確認

### 既に実装済み
- ✅ `ModeContext.tsx` - モード管理のコンテキスト
- ✅ `textResource.ts` - 基本的なテキストリソース（メニュー、一部の画面用）
- ✅ `Layout.tsx` - モード切替ボタンとナビゲーション制御
- ✅ `App.tsx` - ModeProviderでラップ済み

### 未実装・要対応
- ❌ 各ページでのテキストリソース使用
- ❌ エラーメッセージ・成功メッセージのキッズモード対応
- ❌ モーダル内のテキスト対応
- ❌ フォーム内のラベル・プレースホルダー対応
- ❌ キッズモード時のUI調整（ボタンサイズ、フォントサイズなど）
- ❌ テーブルヘッダー・列名の対応
- ❌ バリデーションメッセージの対応

## 実装計画

### フェーズ1: テキストリソースの拡張

#### 1.1 textResource.ts の拡張
以下のテキストキーを追加：

**ふりがなの形式**:
- テキストリソースでは、キッズモード用のテキストに`<ruby>`タグを含める
- 例: `"<ruby>本<rt>ほん</rt></ruby>を <ruby>探<rt>さが</rt></ruby>す"`
- 表示時は、このHTMLを正しくレンダリングする必要がある

**書籍管理画面（BookManagementPage）**
- `booksSubtitle` - 「書籍の登録、編集、削除を行います」→「本（ほん）を 探（さが）したり 借（かり）りたり できるよ」
- `filterAvailableOnly` - 「利用可能な書籍のみ表示」→「借（かり）られる 本（ほん）だけ」
- `colCover` - 「書影」→「本（ほん）の 絵（え）」
- `emptyBooks` - 「書籍が見つかりません」→「本（ほん）が 見（み）つからないよ」
- `modalAddBook` - 「書籍を追加」→「新（あたら）しい 本（ほん）を 入（い）れる」
- `modalEditBook` - 「書籍を編集」→「本（ほん）の 名前（なまえ）を 直（なお）す」
- `modalDeleteBook` - 「書籍を削除」→「本（ほん）を 消（け）す」
- `btnCancel` - 「キャンセル」→「やめる」
- `btnAdd` - 「追加」→「入（い）れる」
- `btnUpdate` - 「更新」→「直（なお）す」
- `btnDelete` - 「削除」→「消（け）す」
- `confirmDelete` - 「本当に削除しますか？」→「本当（ほんとう）に 消（け）す？」
- `deleteWarning` - 「この操作は取り消せません」→「元（もと）に 戻（もど）せないよ」
- `labelIsbn` - 「ISBN」→「バーコード」
- `labelTitle` - 「タイトル」→「本（ほん）の 名前（なまえ）」
- `labelAuthor` - 「著者」→「書（か）いた 人（ひと）」
- `labelCoverUrl` - 「書影URL」→「本（ほん）の 絵（え）の 場所（ばしょ）」
- `helperIsbn` - ISBN入力のヘルパーテキスト
- `btnFetchBookInfo` - 「書籍情報を自動取得」→「本（ほん）の 情報（じょうほう）を 取（と）る」
- `loadingBooks` - 「読み込み中...」→「待（ま）ってね...」
- `noImage` - 「画像なし」→「絵（え）がない」

**貸出・返却画面（LoanManagementPage）**
- `sectionLend` - 「貸出」→「借（かり）る」
- `sectionReturn` - 「返却」→「返（かえ）す」
- `labelMemberBarcode` - 「会員バーコード」→「あなたの バーコード」
- `labelBookBarcode` - 「ISBNバーコード」→「本（ほん）の バーコード」
- `placeholderMemberBarcode` - 「会員バーコードをスキャン」→「バーコードを 見（み）せてね」
- `placeholderBookBarcode` - 「ISBNバーコードをスキャン」→「本（ほん）の バーコードを 見（み）せてね」
- `btnClear` - 「クリア」→「消（け）す」
- `activeLoansTitle` - 「現在貸出中の書籍」→「今（いま） 借（かり）ている 本（ほん）」
- `colBorrower` - 「借りた人」→「借（かり）た 人（ひと）」
- `colBorrowDate` - 「貸出日」→「借（かり）た 日（ひ）」
- `colDaysElapsed` - 「経過日数」→「何日（なんにち） 借（かり）てる？」
- `emptyActiveLoans` - 「現在貸出中の書籍はありません」→「借（かり）ている 本（ほん）は ないよ」
- `loadingLoans` - 「読み込み中...」→「待（ま）ってね...」
- `employeeInfo` - 社員情報表示用のテキスト
- `bookInfo` - 書籍情報表示用のテキスト
- `loanCount` - 「現在の貸出: X / 3 冊」→「今（いま） X冊（さつ） 借（かり）てるよ（3冊（さつ）まで）」

**社員管理画面（EmployeeManagementPage）**
- `employeesTitle` - 「社員管理」→「友達（ともだち） リスト」
- `btnAddEmployee` - 「社員を追加」→「友達（ともだち）を 入（い）れる」
- `colEmployeeId` - 「社員ID」→「番号（ばんごう）」
- `colName` - 「名前」→「名前（なまえ）」
- `colEmail` - 「メールアドレス」→「メールアドレス」
- `colLoaned` - 「貸出中」→「借（かり）てる 本（ほん）」
- `emptyEmployees` - 「社員が見つかりません」→「友達（ともだち）が いないよ」
- `modalAddEmployee` - 「社員を追加」→「友達（ともだち）を 入（い）れる」
- `modalEditEmployee` - 「社員情報を編集」→「友達（ともだち）の 名前（なまえ）を 直（なお）す」
- `modalDeleteEmployee` - 「社員を削除」→「友達（ともだち）を 消（け）す」
- `modalBarcode` - 「会員バーコード」→「あなたの バーコード」
- `labelEmployeeId` - 「社員ID」→「番号（ばんごう）」
- `labelName` - 「名前」→「名前（なまえ）」
- `labelEmail` - 「メールアドレス」→「メールアドレス」
- `placeholderEmployeeId` - 「例: EMP001」→「例（れい）: EMP001」
- `placeholderName` - 「例: 山田太郎」→「例（れい）: 山田（やまだ） 太郎（たろう）」
- `placeholderEmail` - 「例: yamada@company.com」→「例（れい）: yamada@company.com」
- `btnBarcode` - 「バーコード」→「バーコードを 作（つく）る」
- `barcodeDescription` - 「社員ID X のバーコード画像」→「番号（ばんごう） X の バーコード」

**履歴画面（HistoryPage）**
- `historyTitle` - 「貸出履歴」→「借（かり）た 記録（きろく）」
- `filterTitle` - 「フィルター」→「探（さが）す」
- `filterAllBooks` - 「すべての書籍」→「全部（ぜんぶ）の 本（ほん）」
- `filterAllEmployees` - 「すべての社員」→「全部（ぜんぶ）の 人（ひと）」
- `filterAllStatus` - 「すべて」→「全部（ぜんぶ）」
- `filterActive` - 「貸出中」→「借（かり）てる」
- `filterReturned` - 「返却済み」→「返（かえ）した」
- `labelStartDate` - 「開始日」→「始（はじ）まりの 日（ひ）」
- `labelEndDate` - 「終了日」→「終（お）わりの 日（ひ）」
- `btnClearFilters` - 「フィルターをクリア」→「探（さが）すのを 消（け）す」
- `historyCount` - 「X 件の履歴が見つかりました」→「X個（こ） 見（み）つかったよ」
- `colLoanPeriod` - 「貸出期間」→「何日（なんにち） 借（かり）てた？」
- `emptyHistory` - 「履歴が見つかりません」→「記録（きろく）が ないよ」
- `loadingHistory` - 「読み込み中...」→「待（ま）ってね...」

**エラーメッセージ・成功メッセージ**
- `errorLoadBooks` - 「書籍の読み込みに失敗しました」→「本（ほん）が 読（よ）めなかった」
- `errorAddBook` - 「書籍の追加に失敗しました」→「本（ほん）を 入（い）れられなかった」
- `errorUpdateBook` - 「書籍の更新に失敗しました」→「本（ほん）を 直（なお）せなかった」
- `errorDeleteBook` - 「書籍の削除に失敗しました」→「本（ほん）を 消（け）せなかった」
- `errorLoadEmployees` - 「社員の読み込みに失敗しました」→「人（ひと）が 読（よ）めなかった」
- `errorAddEmployee` - 「社員の追加に失敗しました」→「人（ひと）を 入（い）れられなかった」
- `errorUpdateEmployee` - 「社員情報の更新に失敗しました」→「人（ひと）を 直（なお）せなかった」
- `errorDeleteEmployee` - 「社員の削除に失敗しました」→「人（ひと）を 消（け）せなかった」
- `errorLoadLoans` - 「貸出情報の読み込みに失敗しました」→「借（かり）た 記録（きろく）が 読（よ）めなかった」
- `errorBorrow` - 「貸出処理に失敗しました」→「借（かり）られなかった」
- `errorReturn` - 「返却処理に失敗しました」→「返（かえ）せなかった」
- `errorLoadHistory` - 「履歴の読み込みに失敗しました」→「記録（きろく）が 読（よ）めなかった」
- `errorNotFound` - 「見つかりません」→「見（み）つからないよ」
- `errorValidation` - 「すべての項目を正しく入力してください」→「全部（ぜんぶ） 書（か）いてね」
- `successAddBook` - 「書籍を追加しました」→「本（ほん）を 入（い）れたよ」
- `successUpdateBook` - 「書籍を更新しました」→「本（ほん）を 直（なお）したよ」
- `successDeleteBook` - 「書籍を削除しました」→「本（ほん）を 消（け）したよ」
- `successAddEmployee` - 「社員を追加しました」→「人（ひと）を 入（い）れたよ」
- `successUpdateEmployee` - 「社員情報を更新しました」→「人（ひと）を 直（なお）したよ」
- `successDeleteEmployee` - 「社員を削除しました」→「人（ひと）を 消（け）したよ」
- `successBorrow` - 「Xを貸し出しました」→「Xを 借（かり）たよ」
- `successReturn` - 「Xを返却しました」→「Xを 返（かえ）したよ」
- `successBarcode` - 「バーコードを生成しました」→「バーコードを 作（つく）ったよ」
- `errorBarcode` - 「バーコードの生成に失敗しました」→「バーコードを 作（つく）れなかった」

### フェーズ2: 各ページのテキストリソース適用

**重要**: ふりがな付きテキストを表示する際は、`<ruby>`タグを含むHTMLを正しくレンダリングする必要があります。
- `dangerouslySetInnerHTML`を使用するか、専用の`RubyText`コンポーネントを作成
- セキュリティを考慮し、可能な限り専用コンポーネントでのパースを推奨

#### 2.1 BookManagementPage.tsx
- ページタイトル、サブタイトル（ふりがな対応）
- 検索プレースホルダー（ふりがな対応）
- フィルターラベル（ふりがな対応）
- テーブルヘッダー（列名、ふりがな対応）
- ボタンテキスト（ふりがな対応）
- モーダルタイトル・本文（ふりがな対応）
- エラーメッセージ・成功メッセージ（ふりがな対応）
- フォームラベル・プレースホルダー（ふりがな対応）

#### 2.2 LoanManagementPage.tsx
- ページタイトル（ふりがな対応）
- セクションタイトル（ふりがな対応）
- ラベル・プレースホルダー（ふりがな対応）
- ボタンテキスト（ふりがな対応）
- テーブルヘッダー（ふりがな対応）
- エラーメッセージ・成功メッセージ（ふりがな対応）
- 情報表示テキスト（ふりがな対応）

#### 2.3 EmployeeManagementPage.tsx
- ページタイトル（ふりがな対応）
- テーブルヘッダー（ふりがな対応）
- ボタンテキスト（ふりがな対応）
- モーダルタイトル・本文（ふりがな対応）
- フォームラベル・プレースホルダー（ふりがな対応）
- エラーメッセージ・成功メッセージ（ふりがな対応）

#### 2.4 HistoryPage.tsx
- ページタイトル（ふりがな対応）
- フィルターラベル（ふりがな対応）
- テーブルヘッダー（ふりがな対応）
- ボタンテキスト（ふりがな対応）
- エラーメッセージ（ふりがな対応）

### フェーズ3: UI調整（キッズモード時の見た目改善）

#### 3.1 Buttonコンポーネントの拡張
- キッズモード時はデフォルトで `size="lg"` を適用
- フォントサイズを大きく（`text-lg` または `text-xl`）
- パディングを増やす

#### 3.2 Inputコンポーネントの拡張
- キッズモード時はフォントサイズを大きく（`text-lg`）
- ラベルのフォントサイズも大きく
- プレースホルダーのフォントサイズも調整

#### 3.3 Tableコンポーネントの拡張
- キッズモード時はヘッダーのフォントサイズを大きく
- セルのフォントサイズも大きく
- 行の高さを増やす

#### 3.4 全体的なスタイル調整
- キッズモード時はルート要素に `kids-mode` クラスを付与（Layout.tsxで実装済み）
- フォントサイズの基本設定を大きく
- ボタン間隔を広げる
- カードのパディングを増やす

### フェーズ4: エラーメッセージ・成功メッセージの対応

#### 4.1 Toast メッセージの対応
- `useToast` フックを拡張して、キッズモード時にメッセージを変換
- または、各ページで `useAppText` を使ってメッセージを取得してから表示

#### 4.2 バリデーションメッセージの対応
- バリデーション関数で返すエラーメッセージもキッズモード対応
- または、バリデーション関数は通常のメッセージを返し、表示時に変換

### フェーズ5: 細かい調整とテスト

#### 5.1 残りのハードコードされたテキストの確認
- 各ページで直接書かれているテキストをすべて確認
- テキストリソースに追加して置き換え

#### 5.2 UI/UXの最終調整
- キッズモード時の色合い（既にLayout.tsxで一部実装済み）
- アイコンのサイズ調整
- アニメーションの調整（必要に応じて）

#### 5.3 テスト
- 通常モードとキッズモードの切り替えテスト
- 各画面での表示確認
- エラーメッセージ・成功メッセージの表示確認
- モーダルの表示確認

## 実装順序

1. **フェーズ1**: テキストリソースの拡張（textResource.ts）
2. **フェーズ2**: 各ページでのテキストリソース適用
3. **フェーズ3**: UI調整（コンポーネントの拡張）
4. **フェーズ4**: エラーメッセージ・成功メッセージの対応
5. **フェーズ5**: 細かい調整とテスト

## 注意事項

- 機能は一切変更しない（表示のみ変更）
- キッズモード時もすべての機能が利用可能（ただし、社員管理と履歴はナビゲーションから非表示）
- テキストは小学1年生でも理解できるよう、以下の方針で作成：
  - **カタカナはそのまま使用**（例：「バーコード」「スキャン」「メール」など）
  - **簡単な漢字は使用し、ふりがなを付ける**（例：「本（ほん）」「借（かり）る」「返（かえ）す」など）
  - **ふりがなは漢字の上部に表示**（HTMLの`<ruby>`タグを使用）
    - 例：`<ruby>本<rt>ほん</rt></ruby>` → 「本」の上に「ほん」と表示
    - 例：`<ruby>借<rt>かり</rt></ruby>りる` → 「借」の上に「かり」と表示
  - **長い文章は短く区切る**（例：「バーコードをスキャンしてください」→「バーコードを 見（み）せてね」）
  - **親しみやすい表現を使用**（例：「〜してください」→「〜してね」「〜しますか？」→「〜する？」）

### ふりがな表示の実装方法

テキストリソースでは、ふりがな付きのテキストを以下の形式で保存します：
- 通常モード: `"本を探す"`
- キッズモード: `"<ruby>本<rt>ほん</rt></ruby>を <ruby>探<rt>さが</rt></ruby>す"`

表示時は、`dangerouslySetInnerHTML`を使用するか、専用のコンポーネントを作成してふりがなを正しく表示します。

**推奨実装方法**:
- `textResource.ts`で返す文字列に`<ruby>`タグを含める
- 表示するコンポーネントで`dangerouslySetInnerHTML`を使用するか、専用の`RubyText`コンポーネントを作成
- セキュリティ上の懸念がある場合は、専用コンポーネントでパースして表示

## ファイル変更リスト

### 新規作成
- `src/renderer/components/RubyText.tsx` - ふりがな表示用コンポーネント（推奨）
  - `<ruby>`タグを含むテキストを安全にレンダリング
  - または、`dangerouslySetInnerHTML`を使用する場合は各コンポーネントで実装

### 変更が必要なファイル
1. `src/renderer/utils/textResource.ts` - テキストリソースの大幅拡張（ふりがな付きテキストを含む）
2. `src/renderer/components/RubyText.tsx` - ふりがな表示用コンポーネント（新規作成、推奨）
3. `src/renderer/pages/BookManagementPage.tsx` - テキストリソース適用（ふりがな対応）
4. `src/renderer/pages/LoanManagementPage.tsx` - テキストリソース適用（ふりがな対応）
5. `src/renderer/pages/EmployeeManagementPage.tsx` - テキストリソース適用（ふりがな対応）
6. `src/renderer/pages/HistoryPage.tsx` - テキストリソース適用（ふりがな対応）
7. `src/renderer/components/Button.tsx` - キッズモード時のサイズ調整
8. `src/renderer/components/Input.tsx` - キッズモード時のサイズ調整
9. `src/renderer/components/Table.tsx` - キッズモード時のサイズ調整（必要に応じて）

## 見積もり

- フェーズ1: 1-2時間（テキストリソースの追加）
- フェーズ2: 2-3時間（各ページの適用）
- フェーズ3: 1-2時間（UI調整）
- フェーズ4: 1時間（メッセージ対応）
- フェーズ5: 1-2時間（調整とテスト）

**合計: 6-10時間**

