# 要件定義書: キッズモード（小学1年生用モード）

## はじめに

本文書は、既存の図書管理システムにキッズモード機能を実装するための要件を定義します。キッズモードは、小学1年生（6〜7歳程度）向けに最適化されたユーザーインターフェースを提供し、言語の簡略化、漢字へのふりがな追加、UI要素の調整により、読みやすさと使いやすさを向上させます。この機能により、ユーザーは基本機能を変更することなく、通常モードとキッズモードを切り替えることができます。

## 用語集

- **システム**: 図書管理システムアプリケーション
- **キッズモード**: 小学1年生向けに簡略化された言語とふりがなを持つ表示モード
- **通常モード**: 通常の日本語テキストを使用する標準の表示モード
- **ふりがな**: 漢字の読み方を示すために漢字の上に表示される小さなひらがな文字（HTML `<ruby>`タグを使用して実装）
- **テキストリソース**: 通常モードとキッズモードの両方のバリアントを持つUI文字列の一元化されたコレクション
- **モード切替**: 通常モードとキッズモードを切り替えるUIコントロール
- **ルビテキスト**: 漢字の上にふりがなを表示するために使用されるHTMLマークアップ（`<ruby>`および`<rt>`タグ）
- **UIコンポーネント**: Button、Input、Tableなどの再利用可能なインターフェース要素
- **ページ**: アプリケーション内の個別のビュー（書籍管理ページ、貸出管理ページ、社員管理ページ、履歴ページ）
- **トーストメッセージ**: ユーザーに表示される一時的な通知メッセージ
- **モーダル**: メインコンテンツの上に表示されるダイアログボックス

## 要件

### 要件1: テキストリソース管理

**ユーザーストーリー:** システム管理者として、選択されたモードに基づいて年齢に適した言語を表示できるように、すべてのユーザー向けテキストを一元化されたテキストリソースシステムで管理したい。

#### 受入基準

1. WHEN システムがテキストリソースを読み込むとき、THE システム SHALL 各テキストキーに対して通常モードテキストとキッズモードテキストの両方を提供する
2. WHEN キッズモードがアクティブなとき、THE システム SHALL すべてのテキストキーに対してキッズモードテキストバリアントを返す
3. WHEN 通常モードがアクティブなとき、THE システム SHALL すべてのテキストキーに対して通常モードテキストバリアントを返す
4. THE システム SHALL 漢字が出現するキッズモードテキストバリアントにHTML `<ruby>`タグを使用したふりがなマークアップを含める
5. THE システム SHALL 書籍管理ページ、貸出管理ページ、社員管理ページ、履歴ページを含むすべてのページのテキストリソースを維持する

### 要件2: ふりがな表示

**ユーザーストーリー:** 小学1年生として、まだすべての漢字を学習していなくても、テキストを読んで理解できるように、漢字の上にふりがな（読み方ガイド）を見たい。

#### 受入基準

1. WHEN システムがキッズモードで`<ruby>`タグを含むテキストを表示するとき、THE システム SHALL 対応する漢字の上にふりがなをレンダリングする
2. WHEN システムがルビテキストをレンダリングするとき、THE システム SHALL ふりがなが基本の漢字より小さく上に表示される視覚的階層を保持する
3. THE システム SHALL ボタン、ラベル、見出し、テーブルヘッダー、モーダルコンテンツを含むすべてのUIコンポーネントでルビテキストレンダリングをサポートする
4. WHEN システムがテキストリソースを処理するとき、THE システム SHALL セキュリティ脆弱性を導入することなくルビマークアップを処理する

### 要件3: 言語の簡略化

**ユーザーストーリー:** 小学1年生として、図書システムを自分で使えるように、理解できるシンプルで親しみやすい言語を見たい。

#### 受入基準

1. WHEN キッズモードがアクティブなとき、THE システム SHALL カタカナ語を変更せずに表示する（「バーコード」、「スキャン」、「メール」など）
2. WHEN キッズモードがアクティブなとき、THE システム SHALL 簡単な漢字にふりがな注釈を付けて表示する
3. WHEN キッズモードがアクティブなとき、THE システム SHALL 長く複雑な文の代わりに短く区切られた文を使用する
4. WHEN キッズモードがアクティブなとき、THE システム SHALL 親しみやすいカジュアルな表現を使用する（「〜してください」の代わりに「〜してね」など）
5. WHEN キッズモードがアクティブなとき、THE システム SHALL 正式な用語を子供向けの同等語に置き換える（「社員」の代わりに「友達」、「貸出」の代わりに「借りる」など）

### 要件4: UIコンポーネントのサイズ調整

**ユーザーストーリー:** 小学1年生として、インターフェースを簡単に読んで操作できるように、より大きなボタンとテキストが欲しい。

#### 受入基準

1. WHEN キッズモードがアクティブなとき、THE システム SHALL ボタンのフォントサイズを大または特大に増やす
2. WHEN キッズモードがアクティブなとき、THE システム SHALL タッチターゲットを容易にするためにボタンのパディングを増やす
3. WHEN キッズモードがアクティブなとき、THE システム SHALL 入力フィールドのフォントサイズを大に増やす
4. WHEN キッズモードがアクティブなとき、THE システム SHALL 入力フィールドのラベルフォントサイズを増やす
5. WHEN キッズモードがアクティブなとき、THE システム SHALL テーブルヘッダーとセルのフォントサイズを増やす
6. WHEN キッズモードがアクティブなとき、THE システム SHALL 読みやすさを向上させるためにテーブル行の高さを増やす

### 要件5: ページテキストのローカライゼーション

**ユーザーストーリー:** 小学1年生として、システムのすべての機能をナビゲートして使用できるように、すべてのページのすべてのテキストがふりがな付きのシンプルな言語であることを望む。

#### 受入基準

1. WHEN 書籍管理ページでキッズモードがアクティブなとき、THE システム SHALL すべてのページタイトル、サブタイトル、検索プレースホルダー、フィルターラベル、テーブルヘッダー、ボタンテキスト、モーダルコンテンツ、フォームラベル、メッセージをキッズモードテキストリソースを使用して表示する
2. WHEN 貸出管理ページでキッズモードがアクティブなとき、THE システム SHALL すべてのセクションタイトル、ラベル、プレースホルダー、ボタンテキスト、テーブルヘッダー、情報表示をキッズモードテキストリソースを使用して表示する
3. WHEN 社員管理ページでキッズモードがアクティブなとき、THE システム SHALL すべてのページタイトル、テーブルヘッダー、ボタンテキスト、モーダルコンテンツ、フォームラベルをキッズモードテキストリソースを使用して表示する
4. WHEN 履歴ページでキッズモードがアクティブなとき、THE システム SHALL すべてのページタイトル、フィルターラベル、テーブルヘッダー、ボタンテキストをキッズモードテキストリソースを使用して表示する
5. WHEN システムがキッズモードで任意のページを表示するとき、THE システム SHALL すべてのふりがなマークアップを正しくレンダリングする

### 要件6: エラーメッセージと成功メッセージ

**ユーザーストーリー:** 小学1年生として、何が起こったか、次に何をすべきかを理解できるように、シンプルで親しみやすいエラーメッセージと成功メッセージを見たい。

#### 受入基準

1. WHEN キッズモードがアクティブでエラーが発生したとき、THE システム SHALL 簡略化されたキッズモード言語を使用してエラーメッセージを表示する
2. WHEN キッズモードがアクティブで操作が成功したとき、THE システム SHALL 簡略化されたキッズモード言語を使用して成功メッセージを表示する
3. WHEN システムがキッズモードでトースト通知を表示するとき、THE システム SHALL すべてのメッセージコンテンツにキッズモードテキストバリアントを使用する
4. WHEN システムがキッズモードでバリデーションエラーを表示するとき、THE システム SHALL すべてのバリデーションメッセージにキッズモードテキストバリアントを使用する
5. THE システム SHALL 読み込み失敗、追加失敗、更新失敗、削除失敗、見つからないエラーを含むすべてのエラータイプのキッズモードバリアントを含める

### 要件7: モード切替機能

**ユーザーストーリー:** ユーザーとして、自分のニーズに最も適したインターフェースを選択できるように、通常モードとキッズモードを簡単に切り替えたい。

#### 受入基準

1. WHEN ユーザーがモード切替ボタンをクリックするとき、THE システム SHALL 通常モードとキッズモードを切り替える
2. WHEN モードが変更されるとき、THE システム SHALL 新しいモードを反映するためにすべての表示テキストを即座に更新する
3. WHEN モードが変更されるとき、THE システム SHALL 新しいモードを反映するためにすべてのUIコンポーネントサイズを即座に更新する
4. WHEN キッズモードがアクティブなとき、THE システム SHALL モード切替ボタンに視覚的インジケーターを表示する
5. THE システム SHALL ユーザーセッション全体を通じて選択されたモードを維持する

### 要件8: ナビゲーション表示制御

**ユーザーストーリー:** システム管理者として、若いユーザーが図書館のコア機能に焦点を当てた簡略化されたインターフェースを見られるように、キッズモードで特定の高度な機能を非表示にしたい。

#### 受入基準

1. WHEN キッズモードがアクティブなとき、THE システム SHALL 社員管理ページのナビゲーション項目を非表示にする
2. WHEN キッズモードがアクティブなとき、THE システム SHALL 履歴ページのナビゲーション項目を非表示にする
3. WHEN キッズモードがアクティブなとき、THE システム SHALL 書籍管理ページのナビゲーション項目を表示する
4. WHEN キッズモードがアクティブなとき、THE システム SHALL 貸出管理ページのナビゲーション項目を表示する
5. WHEN 通常モードがアクティブなとき、THE システム SHALL すべてのナビゲーション項目を表示する

### 要件9: ビジュアルテーマの調整

**ユーザーストーリー:** 小学1年生として、システムが歓迎的で楽しく使えるように感じられるように、インターフェースに温かく親しみやすい色を持たせたい。

#### 受入基準

1. WHEN キッズモードがアクティブなとき、THE システム SHALL ヘッダー背景に温かい配色を適用する
2. WHEN キッズモードがアクティブなとき、THE システム SHALL ナビゲーション項目のアイコンサイズを増やす
3. WHEN キッズモードがアクティブなとき、THE システム SHALL モード切替ボタンに特徴的な視覚スタイルを適用する
4. WHEN キッズモードがアクティブなとき、THE システム SHALL インタラクティブ要素間のスペーシングを増やす
5. WHEN キッズモードがアクティブなとき、THE システム SHALL カードコンポーネントのパディングを増やす

### 要件10: 機能の同等性

**ユーザーストーリー:** システム管理者として、若いユーザーが必要なすべての図書館操作を実行できるように、キッズモードが通常モードと同じ機能を提供することを望む。

#### 受入基準

1. WHEN キッズモードがアクティブなとき、THE システム SHALL ユーザーが通常モードと同じ機能で書籍を検索できるようにする
2. WHEN キッズモードがアクティブなとき、THE システム SHALL ユーザーが通常モードと同じ機能で書籍を借りられるようにする
3. WHEN キッズモードがアクティブなとき、THE システム SHALL ユーザーが通常モードと同じ機能で書籍を返却できるようにする
4. WHEN キッズモードがアクティブなとき、THE システム SHALL 通常モードと同じビジネスルールを適用する（3冊の借用制限など）
5. WHEN モードが変更されるとき、THE システム SHALL 現在のページ、フォームデータ、検索フィルターを含むすべてのアプリケーション状態を保持する
