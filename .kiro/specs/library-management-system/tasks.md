# 実装タスクリスト

## 概要

このタスクリストは、社内図書管理システム（Electron + React + TypeScript）の実装手順を定義します。各タスクは段階的に実装し、前のタスクの成果物を活用しながら進めます。

---

## タスク

- [x] 1. プロジェクトのセットアップと基本構造の構築
  - Electron + React + TypeScript + Vite のプロジェクト初期化
  - 必要な依存関係のインストール（electron, react, react-router-dom, tailwindcss, uuid, bwip-js等）
  - ディレクトリ構造の作成（src/main, src/renderer, src/models, src/services, src/repositories, src/utils）
  - TypeScript設定ファイル（tsconfig.json）の作成
  - ESLintとPrettierの設定
  - _要件: 7.1, 7.4_

- [x] 2. データモデルとインターフェースの定義
  - Book、Employee、LoanRecordのインターフェース定義
  - BookStatus、LoanStatusのenum定義
  - LibraryErrorカスタムエラークラスの実装
  - ErrorCodeのenum定義
  - _要件: 1.1, 2.1, 3.4, 6.4_

- [x] 3. リポジトリ層の実装
  - IRepository<T>インターフェースの定義
  - JSONファイル読み書きユーティリティの実装
  - BookRepositoryの実装（CRUD操作、検索機能）
  - EmployeeRepositoryの実装（CRUD操作）
  - LoanRepositoryの実装（CRUD操作、履歴検索）
  - データディレクトリ（data/）の初期化処理
  - _要件: 7.1, 7.2, 7.3, 7.4, 7.5_

- [x] 4. バーコードサービスの実装
  - BarcodeServiceクラスの実装
  - 会員バーコード画像生成機能（bwip-jsを使用、CODE128形式）
  - ISBN形式検証機能
  - バーコード画像保存機能（data/barcodes/ディレクトリ）
  - _要件: 2.3, 2.4, 1.3_

- [x] 5. ビジネスロジック層（サービス層）の実装
- [x] 5.1 BookServiceの実装
  - 書籍追加機能（UUID生成、ISBN検証）
  - 書籍更新機能
  - 書籍削除機能（貸出中チェック）
  - 書籍検索機能（タイトル・著者）
  - 利用可能書籍フィルタリング
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 5.1, 5.2, 5.5_

- [x] 5.2 EmployeeServiceの実装
  - 社員追加機能（会員バーコード自動生成）
  - 社員更新機能
  - 社員削除機能（貸出中書籍チェック）
  - 社員検索機能（ID、バーコード）
  - バーコード発行機能
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7_

- [x] 5.3 LoanServiceの実装
  - 貸出機能（在庫チェック、貸出上限チェック、記録作成）
  - 返却機能（貸出状態チェック、記録更新）
  - 貸出履歴取得機能（書籍別、社員別）
  - 現在貸出中一覧取得機能
  - _要件: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 4.1, 4.2, 4.3, 4.4, 4.5, 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 6. Electronメインプロセスの実装
  - Electronアプリケーションの初期化
  - ウィンドウ作成と管理
  - IPC通信ハンドラーの実装（books:*, employees:*, loans:*）
  - サービス層のインスタンス化と接続
  - ファイルシステムアクセス処理
  - _要件: すべての要件に対応_

- [x] 7. React UIコンポーネントの実装
- [x] 7.1 共通コンポーネントの作成
  - Layoutコンポーネント（Header、Navigation）
  - Buttonコンポーネント
  - Inputコンポーネント（バーコードスキャン対応）
  - Tableコンポーネント
  - Modalコンポーネント
  - Toast通知コンポーネント（成功・エラーメッセージ表示）
  - _要件: すべての画面で使用_

- [x] 7.2 書籍管理画面の実装
  - BookManagementPageコンポーネント
  - 書籍一覧テーブル表示
  - 検索バー実装（タイトル・著者）
  - フィルター実装（利用可能のみ）
  - 書籍追加モーダル（ISBNバーコードスキャン対応）
  - 書籍編集モーダル
  - 書籍削除確認ダイアログ
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 7.3 社員管理画面の実装
  - EmployeeManagementPageコンポーネント
  - 社員一覧テーブル表示（貸出中冊数表示）
  - 社員追加モーダル
  - 社員編集モーダル
  - 社員削除確認ダイアログ
  - バーコード発行機能（プレビュー、保存、印刷）
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7_

- [x] 7.4 貸出・返却画面の実装
  - LoanManagementPageコンポーネント
  - 貸出セクション（会員バーコード入力、ISBN入力、社員情報表示、書籍情報表示）
  - 返却セクション（ISBN入力、貸出情報表示）
  - 現在貸出中書籍一覧テーブル
  - バーコードスキャン時の自動フォーカス移動
  - _要件: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 4.1, 4.2, 4.3, 4.4, 4.5_

- [x] 7.5 履歴画面の実装
  - HistoryPageコンポーネント
  - 貸出履歴テーブル表示
  - フィルター実装（書籍別、社員別、期間別）
  - 履歴データのソート機能
  - _要件: 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 8. ルーティングとナビゲーションの実装
  - React Routerのセットアップ
  - ルート定義（/, /employees, /loans, /history）
  - ナビゲーションタブの実装
  - アクティブタブのハイライト
  - _要件: すべての画面間の遷移_

- [x] 9. スタイリングとUI/UXの実装
  - Tailwind CSSの設定
  - カラースキームの適用（プライマリ、成功、警告、エラー）
  - レスポンシブレイアウトの実装
  - フォントサイズとスタイルの統一
  - アクセシビリティ対応（キーボードナビゲーション、フォーカス管理）
  - _要件: すべての画面_

- [x] 10. エラーハンドリングとバリデーションの実装
  - 入力バリデーション（ISBN形式、メールアドレス形式等）
  - エラーメッセージの日本語化
  - エラー時のToast通知表示
  - 確認ダイアログの実装（削除操作等）
  - _要件: 1.6, 2.7, 3.5, 3.7, 4.4, 7.5_

- [x] 11. データ初期化とサンプルデータの作成
  - 初回起動時のデータディレクトリ作成
  - サンプル書籍データの作成（5冊程度）
  - サンプル社員データの作成（3名程度）
  - 空の貸出履歴ファイルの作成
  - _要件: 7.1, 7.2, 7.3, 7.4_

- [x] 12. ビルドとパッケージングの設定
  - Electron Builderの設定
  - アプリケーションアイコンの作成
  - Windows/Mac/Linux向けビルド設定
  - インストーラーの作成設定
  - _要件: デプロイメント_

- [x] 13. ISBN自動取得機能の実装（国立国会図書館API）
  - BookInfoServiceの実装（ISBN検索、XMLパース、データクレンジング）
  - 新規エラーコード追加（BOOK_INFO_NOT_FOUND, BOOK_INFO_FETCH_FAILED等）
  - メインプロセスにIPCハンドラー追加（books:fetchInfo）
  - BookManagementPageにISBN自動取得機能を統合
  - ISBN入力時の自動取得トリガー（Enterキー押下時）
  - ローディングインジケーター表示
  - 自動取得失敗時の手動入力フォールバック
  - タイムアウト処理（5秒）
  - _要件: 1.4, 1.5_

